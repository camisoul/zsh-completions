SHELL = /bin/sh
LIST  = COMPLETIONS

COLUMN = @COLUMN@
AWK    = @AWK@
FGREP  = @FGREP@
SED    = @SED@

$(LIST): src/*
	$(FGREP) compdef src/* | $(AWK) '{ $$1 = ""; print }' | $(SED) 's/ /\n/g' | $(AWK) 'BEGIN { FS = "=" } length() > 0 { print $$1 }' > $(@)

.PHONY: show
show:
	cat $(LIST) | $(COLUMN)

.PHONY: clean
clean:
	-$(RM) $(LIST)

.PHONY: distclean
distclean:
	-$(RM) $(LIST)
	-$(RM) config.log config.status Makefile
